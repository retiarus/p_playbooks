---
- name: install terminal packages
  apt:
    name: "{{ item }}"
    state: present
  loop: "{{ terminal_p }}"
  ignore_errors: True

- name: set default shell to zsh
  user:
    name: peregrinus
    shell: /bin/zsh

- name: Create a 4096-bit SSH key for user peregrinus
  user:
    name: peregrinus
    generate_ssh_key: yes
    ssh_key_bits: 4096
    ssh_key_file: .ssh/id_rsa

- name: install pipenv, virtualenvwrapper
  pip:
    name: "{{ item }}"
    executable: pip3
    extra_args: --user
  with_items:
    - pipenv
    - virtualenvwrapper
  become: yes
  become_user: peregrinus
  ignore_errors: yes

- name: install pipenv, virtualenvwrapper
  pip:
    name: "{{ item }}"
    executable: pip
    extra_args: --user
  with_items:
    - pipenv
    - virtualenvwrapper
  become: yes
  become_user: peregrinus
  ignore_errors: yes

- name: add user peregrinus to dialout
  user:
    name: peregrinus
    groups: dialout, users
    append: yes

- name: set primary group to peregrinus
  user:
    name: peregrinus
    group: peregrinus
    append: yes

- name: clone p_dotfiles
  git:
    repo: 'https://github.com/retiarus/p_dotfiles'
    dest: "{{ user_dotfiles | default('/home/peregrinus/p_dotfiles') }}"
    clone: yes
    update: yes
    recursive: yes
    force: yes
  become_user: "{{ user }}"

- name: crete dir's to home in mnt
  file:
    path: "{{ item }}"
    state: directory
    owner: "{{ user }}"
    group: "{{ user }}"
  with_items:
    - '/mnt/falco02'
    - '/mnt/falco03'
    - '/mnt/falco06'
    - '/mnt/iso'
    - '/mnt/animes'
    - '/mnt/filmes'
    - '/mnt/imagens'
    - '/mnt/arquivos'
    - '/mnt/organizar'
    - '/mnt/downloads'
    - '/mnt/experimentos'
    - '/mnt/downloads-flexget'
    - '/mnt/mpiuser'
    - '/mnt/sda'
    - '/mnt/sdb'
    - '/mnt/sdc'
    - '/mnt/sdd'
    - '/mnt/sde'
    - '/mnt/sdf'
    - '/mnt/sdg'
    - '/mnt/sdh'
    - '/mnt/ubuntu-server-02:raid_falco'
    - '/mnt/home_falco'
  ignore_errors: yes

- name: add hosts to host file
  lineinfile:
    path: "/etc/hosts"
    line: "{{ item }}"
  loop:
    - "192.168.5.11  ubuntu-server-01 ubuntu-server-01.falco.net"
    - "192.168.5.12  ubuntu-server-02 ubuntu-server-02.falco.net"
    - "192.168.5.13  ubuntu-server-03 ubuntu-server-03.falco.net"
    - "192.168.5.3   falco03          falco03.falco.net"
    - "192.168.5.254 openwrt          openwrt.falco.net"

- name: add entrys to fstab file
  lineinfile:
    path: "/etc/fstab"
    line: "{{ item }}"
  loop:
    - "ubuntu-server-02.falco.net:experimentos     /home/peregrinus/experimentos     nfs noatime,noacl,nocto,wsize=32768,rsize=32768           0 0"
    - "ubuntu-server-02.falco.net:arquivos         /home/peregrinus/arquivos         nfs noatime,noacl,nocto,wsize=32768,rsize=32768           0 0"
    - "ubuntu-server-02.falco.net:experimentos     /mnt/experimentos                 nfs noatime,noacl,nocto,wsize=32768,rsize=32768           0 0"
    - "ubuntu-server-02.falco.net:arquivos         /mnt/arquivos                     nfs noatime,noacl,nocto,wsize=32768,rsize=32768           0 0"
...
